{"version":3,"file":"index-CqSaLBiy.js","sources":["../../src/canvas.js","../../src/websocket.js","../../src/auth.js","../../src/main.js"],"sourcesContent":["// src/canvas.js\n// Complete PixiJS Canvas Manager for CollabCanvas\nimport * as PIXI from 'pixi.js';\n\nexport class CanvasManager {\n  constructor(app) {\n    this.app = app;\n    this.viewport = new PIXI.Container();\n    this.objects = new Map(); // objectId -> PIXI Graphics\n    this.selectedObjects = new Set();\n    this.selectionIndicators = new Map(); // objectId -> selection box Graphics\n    this.remoteCursors = new Map(); // userId -> cursor container\n\n    // State\n    this.isPanning = false;\n    this.panStart = { x: 0, y: 0 };\n    this.currentTool = 'select'; // 'select', 'rectangle', 'circle', 'text'\n    this.currentColor = 0x3498db; // Default blue\n    \n    // Viewport setup\n    this.app.stage.addChild(this.viewport);\n    this.viewport.sortableChildren = true;\n    \n    // Grid background (optional visual aid)\n    this.drawGrid();\n    \n    // Setup interaction\n    this.setupPanZoom();\n    this.setupKeyboardShortcuts();\n    this.setupToolHandlers();\n    \n    console.log('Canvas initialized');\n  }\n  \n  // ==================== Grid ====================\n  \n  drawGrid() {\n    const grid = new PIXI.Graphics();\n    grid.lineStyle(1, 0x333333, 0.3);\n    \n    const gridSize = 50;\n    const gridExtent = 5000;\n    \n    // Vertical lines\n    for (let x = -gridExtent; x <= gridExtent; x += gridSize) {\n      grid.moveTo(x, -gridExtent);\n      grid.lineTo(x, gridExtent);\n    }\n    \n    // Horizontal lines\n    for (let y = -gridExtent; y <= gridExtent; y += gridSize) {\n      grid.moveTo(-gridExtent, y);\n      grid.lineTo(gridExtent, y);\n    }\n    \n    grid.zIndex = -1;\n    this.viewport.addChild(grid);\n  }\n  \n  // ==================== Pan & Zoom ====================\n  \n  setupPanZoom() {\n    const canvas = this.app.view;\n    \n    // Pan with middle mouse or Alt+drag\n    canvas.addEventListener('mousedown', (e) => {\n      if (e.button === 1 || (e.button === 0 && e.altKey)) {\n        this.isPanning = true;\n        this.panStart = { x: e.clientX, y: e.clientY };\n        canvas.style.cursor = 'grabbing';\n        e.preventDefault();\n      }\n    });\n    \n    canvas.addEventListener('mousemove', (e) => {\n      if (this.isPanning) {\n        const dx = e.clientX - this.panStart.x;\n        const dy = e.clientY - this.panStart.y;\n        \n        this.viewport.x += dx;\n        this.viewport.y += dy;\n        \n        this.panStart = { x: e.clientX, y: e.clientY };\n      }\n    });\n    \n    canvas.addEventListener('mouseup', () => {\n      if (this.isPanning) {\n        this.isPanning = false;\n        canvas.style.cursor = 'default';\n      }\n    });\n    \n    // Zoom with mouse wheel\n    canvas.addEventListener('wheel', (e) => {\n      e.preventDefault();\n      \n      const zoomFactor = e.deltaY > 0 ? 0.9 : 1.1;\n      const mouseX = e.clientX;\n      const mouseY = e.clientY;\n      \n      // Get position before zoom\n      const worldPosBefore = this.screenToWorld(mouseX, mouseY);\n      \n      // Apply zoom\n      const newScale = this.viewport.scale.x * zoomFactor;\n      if (newScale >= 0.1 && newScale <= 10) {\n        this.viewport.scale.set(newScale);\n        \n        // Adjust position to keep mouse over same world point\n        const worldPosAfter = this.screenToWorld(mouseX, mouseY);\n        this.viewport.x += (worldPosAfter.x - worldPosBefore.x) * this.viewport.scale.x;\n        this.viewport.y += (worldPosAfter.y - worldPosBefore.y) * this.viewport.scale.y;\n      }\n    }, { passive: false });\n  }\n  \n  screenToWorld(screenX, screenY) {\n    return {\n      x: (screenX - this.viewport.x) / this.viewport.scale.x,\n      y: (screenY - this.viewport.y) / this.viewport.scale.y\n    };\n  }\n  \n  worldToScreen(worldX, worldY) {\n    return {\n      x: worldX * this.viewport.scale.x + this.viewport.x,\n      y: worldY * this.viewport.scale.y + this.viewport.y\n    };\n  }\n  \n  // ==================== Keyboard Shortcuts ====================\n  \n  setupKeyboardShortcuts() {\n    document.addEventListener('keydown', (e) => {\n      // Tool shortcuts\n      if (e.key === 'r' || e.key === 'R') {\n        this.setTool('rectangle');\n      } else if (e.key === 'c' || e.key === 'C') {\n        this.setTool('circle');\n      } else if (e.key === 't' || e.key === 'T') {\n        this.setTool('text');\n      } else if (e.key === 'v' || e.key === 'V' || e.key === 'Escape') {\n        this.setTool('select');\n      } else if (e.key === 'Delete' || e.key === 'Backspace') {\n        this.deleteSelected();\n      }\n    });\n  }\n  \n  setTool(tool) {\n    this.currentTool = tool;\n    console.log('Tool:', tool);\n    // Update UI indicator if you have one\n  }\n  \n  // ==================== Tool Handlers ====================\n  \n  setupToolHandlers() {\n    const canvas = this.app.view;\n    let drawStart = null;\n    let previewShape = null;\n\n    // Track cursor movement\n    canvas.addEventListener('mousemove', (e) => {\n      const worldPos = this.screenToWorld(e.clientX, e.clientY);\n\n      // Notify about cursor movement\n      if (this.onCursorMoved) {\n        this.onCursorMoved(worldPos.x, worldPos.y);\n      }\n\n      // Handle preview shape drawing\n      if (drawStart && previewShape) {\n        const width = worldPos.x - drawStart.x;\n        const height = worldPos.y - drawStart.y;\n\n        previewShape.clear();\n        previewShape.beginFill(this.currentColor);\n\n        if (this.currentTool === 'rectangle') {\n          previewShape.drawRect(drawStart.x, drawStart.y, width, height);\n        } else if (this.currentTool === 'circle') {\n          const radius = Math.sqrt(width * width + height * height);\n          previewShape.drawCircle(drawStart.x, drawStart.y, radius);\n        }\n\n        previewShape.endFill();\n      }\n    });\n\n    canvas.addEventListener('mousedown', (e) => {\n      if (e.button !== 0 || e.altKey) return; // Left click only, not panning\n      \n      const worldPos = this.screenToWorld(e.clientX, e.clientY);\n      \n      if (this.currentTool === 'rectangle' || this.currentTool === 'circle') {\n        drawStart = worldPos;\n        \n        // Create preview shape\n        previewShape = new PIXI.Graphics();\n        previewShape.alpha = 0.5;\n        this.viewport.addChild(previewShape);\n      }\n    });\n\n    canvas.addEventListener('mouseup', (e) => {\n      if (drawStart && previewShape) {\n        const worldPos = this.screenToWorld(e.clientX, e.clientY);\n        \n        // Create actual object\n        const objData = this.createToolObject(drawStart, worldPos);\n        \n        // Clean up preview\n        this.viewport.removeChild(previewShape);\n        previewShape = null;\n        drawStart = null;\n        \n        // Notify about new object (callback to WebSocket)\n        if (this.onObjectCreated) {\n          this.onObjectCreated(objData);\n        }\n      }\n    });\n  }\n  \n  createToolObject(start, end) {\n    const id = this.generateId();\n    \n    if (this.currentTool === 'rectangle') {\n      const width = Math.abs(end.x - start.x);\n      const height = Math.abs(end.y - start.y);\n      const x = Math.min(start.x, end.x);\n      const y = Math.min(start.y, end.y);\n      \n      this.createRectangle(id, x, y, width, height, this.currentColor);\n      \n      return {\n        id,\n        type: 'rectangle',\n        x, y, width, height,\n        color: this.currentColor\n      };\n    } else if (this.currentTool === 'circle') {\n      const dx = end.x - start.x;\n      const dy = end.y - start.y;\n      const radius = Math.sqrt(dx * dx + dy * dy);\n      \n      this.createCircle(id, start.x, start.y, radius, this.currentColor);\n      \n      return {\n        id,\n        type: 'circle',\n        x: start.x,\n        y: start.y,\n        radius,\n        color: this.currentColor\n      };\n    }\n  }\n  \n  // ==================== Object Creation ====================\n  \n  createRectangle(id, x, y, width, height, color) {\n    const rect = new PIXI.Graphics();\n    rect.beginFill(color);\n    rect.drawRect(0, 0, width, height);\n    rect.endFill();\n    rect.x = x;\n    rect.y = y;\n    rect.interactive = true;\n    rect.buttonMode = true;\n\n    // Store dimensions for selection box\n    rect.userData = { width, height, type: 'rectangle' };\n\n    this.makeDraggable(rect, id);\n    this.makeSelectable(rect, id);\n\n    this.objects.set(id, rect);\n    this.viewport.addChild(rect);\n\n    return rect;\n  }\n  \n  createCircle(id, x, y, radius, color) {\n    const circle = new PIXI.Graphics();\n    circle.beginFill(color);\n    circle.drawCircle(0, 0, radius);\n    circle.endFill();\n    circle.x = x;\n    circle.y = y;\n    circle.interactive = true;\n    circle.buttonMode = true;\n\n    // Store dimensions for selection box\n    circle.userData = { radius, type: 'circle' };\n\n    this.makeDraggable(circle, id);\n    this.makeSelectable(circle, id);\n\n    this.objects.set(id, circle);\n    this.viewport.addChild(circle);\n\n    return circle;\n  }\n  \n  createText(id, text, x, y, fontSize, color) {\n    const textObj = new PIXI.Text(text, {\n      fontSize,\n      fill: color,\n      fontFamily: 'Arial'\n    });\n    textObj.x = x;\n    textObj.y = y;\n    textObj.interactive = true;\n    textObj.buttonMode = true;\n    \n    this.makeDraggable(textObj, id);\n    this.makeSelectable(textObj, id);\n    \n    this.objects.set(id, textObj);\n    this.viewport.addChild(textObj);\n    \n    return textObj;\n  }\n  \n  // ==================== Interaction ====================\n  \n  makeDraggable(obj, id) {\n    let dragData = null;\n    let dragOffset = { x: 0, y: 0 };\n    let lastDragUpdate = 0;\n    const dragUpdateInterval = 50; // Send updates every 50ms during drag (~20 FPS)\n\n    obj.on('pointerdown', (event) => {\n      if (this.currentTool !== 'select') return;\n\n      dragData = event.data;\n      obj.alpha = 0.7;\n      dragData.dragging = true;\n\n      // Store the offset between cursor and object position\n      const cursorPos = dragData.getLocalPosition(obj.parent);\n      dragOffset.x = cursorPos.x - obj.x;\n      dragOffset.y = cursorPos.y - obj.y;\n\n      event.stopPropagation();\n    });\n\n    obj.on('pointerup', () => {\n      if (dragData && dragData.dragging) {\n        obj.alpha = 1;\n        dragData.dragging = false;\n\n        // Send final position update\n        if (this.onObjectUpdated) {\n          this.onObjectUpdated(id, { x: obj.x, y: obj.y });\n        }\n\n        dragData = null;\n      }\n    });\n\n    obj.on('pointermove', () => {\n      if (dragData && dragData.dragging) {\n        const newPosition = dragData.getLocalPosition(obj.parent);\n        // Apply the offset to maintain cursor position relative to object\n        obj.x = newPosition.x - dragOffset.x;\n        obj.y = newPosition.y - dragOffset.y;\n\n        // Send throttled updates during drag for real-time visualization\n        const now = performance.now();\n        if (now - lastDragUpdate >= dragUpdateInterval) {\n          if (this.onObjectUpdated) {\n            this.onObjectUpdated(id, { x: obj.x, y: obj.y });\n          }\n          lastDragUpdate = now;\n        }\n      }\n    });\n  }\n  \n  makeSelectable(obj, id) {\n    obj.on('click', (event) => {\n      if (this.currentTool === 'select') {\n        if (event.data.originalEvent.shiftKey) {\n          // Multi-select\n          if (this.selectedObjects.has(id)) {\n            this.deselectObject(id);\n          } else {\n            this.selectObject(id);\n          }\n        } else {\n          // Single select\n          this.clearSelection();\n          this.selectObject(id);\n        }\n        event.stopPropagation();\n      }\n    });\n  }\n  \n  selectObject(id) {\n    const obj = this.objects.get(id);\n    if (!obj) return;\n\n    this.selectedObjects.add(id);\n\n    // Remove existing selection indicator if any\n    const existingIndicator = this.selectionIndicators.get(id);\n    if (existingIndicator) {\n      this.viewport.removeChild(existingIndicator);\n      existingIndicator.destroy();\n    }\n\n    // Create selection indicator\n    const indicator = new PIXI.Graphics();\n    indicator.lineStyle(2, 0x00FF00);\n\n    if (obj.userData) {\n      if (obj.userData.type === 'rectangle') {\n        // Draw selection box around rectangle\n        const { width, height } = obj.userData;\n        indicator.drawRect(-2, -2, width + 4, height + 4);\n        indicator.x = obj.x;\n        indicator.y = obj.y;\n      } else if (obj.userData.type === 'circle') {\n        // Draw selection box around circle\n        const { radius } = obj.userData;\n        indicator.drawCircle(0, 0, radius + 2);\n        indicator.x = obj.x;\n        indicator.y = obj.y;\n      }\n    }\n\n    // Add to viewport and store reference\n    this.viewport.addChild(indicator);\n    this.selectionIndicators.set(id, indicator);\n  }\n\n  deselectObject(id) {\n    const obj = this.objects.get(id);\n    if (!obj) return;\n\n    this.selectedObjects.delete(id);\n\n    // Remove selection indicator\n    const indicator = this.selectionIndicators.get(id);\n    if (indicator) {\n      this.viewport.removeChild(indicator);\n      indicator.destroy();\n      this.selectionIndicators.delete(id);\n    }\n  }\n  \n  clearSelection() {\n    this.selectedObjects.forEach(id => this.deselectObject(id));\n    this.selectedObjects.clear();\n  }\n  \n  deleteSelected() {\n    this.selectedObjects.forEach(id => {\n      this.deleteObject(id);\n      if (this.onObjectDeleted) {\n        this.onObjectDeleted(id);\n      }\n    });\n    this.selectedObjects.clear();\n  }\n  \n  // ==================== Object Management ====================\n\n  loadState(canvasState) {\n    console.error('========================================');\n    console.error('=== LOAD STATE CALLED ===');\n    console.error('========================================');\n    console.error('Canvas state received:', canvasState);\n    console.error('Canvas state type:', typeof canvasState);\n    console.error('Is array?', Array.isArray(canvasState));\n\n    // Clear existing objects\n    console.error('Clearing existing objects...');\n    this.objects.forEach((obj, id) => {\n      this.deleteObject(id);\n    });\n    console.error('Objects cleared. Map size:', this.objects.size);\n\n    // Load objects from state\n    if (canvasState && typeof canvasState === 'object') {\n      // If it's an array, iterate through it\n      if (Array.isArray(canvasState)) {\n        console.error(`=== Loading ${canvasState.length} objects from ARRAY ===`);\n        canvasState.forEach((objData, index) => {\n          console.error(`Loading object ${index}:`, JSON.stringify(objData));\n          this.createRemoteObject(objData);\n        });\n      } else {\n        // If it's an object/hash, iterate through its values\n        const values = Object.values(canvasState);\n        console.error(`=== Loading ${values.length} objects from OBJECT ===`);\n        values.forEach((objData, index) => {\n          console.error(`Loading object ${index}:`, JSON.stringify(objData));\n          this.createRemoteObject(objData);\n        });\n      }\n    } else {\n      console.error('!!! INVALID canvas state !!!:', canvasState);\n    }\n\n    console.error('========================================');\n    console.error(`=== LOAD STATE COMPLETE: ${this.objects.size} objects ===`);\n    console.error('Current objects in map:', Array.from(this.objects.keys()));\n    console.error('========================================');\n  }\n\n  updateObject(id, updates) {\n    const obj = this.objects.get(id);\n    if (!obj) return;\n\n    if (updates.x !== undefined) obj.x = updates.x;\n    if (updates.y !== undefined) obj.y = updates.y;\n\n    // For Graphics objects, need to redraw if dimensions change\n    if (obj instanceof PIXI.Graphics) {\n      if (updates.width !== undefined || updates.height !== undefined) {\n        // Recreate the shape - this is simplistic, you might want a better approach\n        console.log('Dimension updates for Graphics require recreation');\n      }\n    }\n  }\n\n  deleteObject(id) {\n    const obj = this.objects.get(id);\n    if (obj) {\n      this.viewport.removeChild(obj);\n      this.objects.delete(id);\n      obj.destroy();\n\n      // Clean up selection indicator if it exists\n      const indicator = this.selectionIndicators.get(id);\n      if (indicator) {\n        this.viewport.removeChild(indicator);\n        indicator.destroy();\n        this.selectionIndicators.delete(id);\n      }\n\n      // Remove from selected objects set\n      this.selectedObjects.delete(id);\n    }\n  }\n\n  // ==================== Remote Object Sync ====================\n\n  createRemoteObject(objData) {\n    console.log('Creating remote object:', objData);\n    console.log('Object properties:', {\n      id: objData.id,\n      type: objData.type,\n      x: objData.x,\n      y: objData.y,\n      width: objData.width,\n      height: objData.height,\n      radius: objData.radius,\n      color: objData.color,\n      colorType: typeof objData.color\n    });\n\n    // Convert color to proper format (ensure it's a number)\n    const color = this.normalizeColor(objData.color);\n    console.log('Normalized color:', color, 'type:', typeof color);\n\n    // Infer type from data if missing (backwards compatibility)\n    let type = objData.type;\n    if (!type) {\n      console.warn('Object missing type field, inferring from properties:', objData);\n      if (objData.radius !== undefined) {\n        type = 'circle';\n      } else if (objData.width !== undefined && objData.height !== undefined) {\n        type = 'rectangle';\n      } else if (objData.text !== undefined) {\n        type = 'text';\n      } else {\n        console.error('Cannot infer type for object:', objData);\n        return;\n      }\n    }\n\n    if (type === 'rectangle') {\n      // Validate dimensions\n      if (!objData.width || !objData.height || objData.width <= 0 || objData.height <= 0) {\n        console.warn('Skipping rectangle with invalid dimensions:', objData);\n        return;\n      }\n\n      console.log('Creating rectangle with:', {\n        id: objData.id,\n        x: objData.x,\n        y: objData.y,\n        width: objData.width,\n        height: objData.height,\n        color: color\n      });\n      this.createRectangle(\n        objData.id,\n        objData.x,\n        objData.y,\n        objData.width,\n        objData.height,\n        color\n      );\n      console.log('Rectangle created successfully. Objects in map:', this.objects.size);\n    } else if (type === 'circle') {\n      console.log('Creating circle with:', {\n        id: objData.id,\n        x: objData.x,\n        y: objData.y,\n        radius: objData.radius,\n        color: color\n      });\n      this.createCircle(\n        objData.id,\n        objData.x,\n        objData.y,\n        objData.radius,\n        color\n      );\n      console.log('Circle created successfully');\n    } else if (type === 'text') {\n      console.log('Creating text with:', {\n        id: objData.id,\n        text: objData.text,\n        x: objData.x,\n        y: objData.y,\n        fontSize: objData.fontSize,\n        color: color\n      });\n      this.createText(\n        objData.id,\n        objData.text,\n        objData.x,\n        objData.y,\n        objData.fontSize,\n        color\n      );\n      console.log('Text created successfully');\n    } else {\n      console.error('Unknown object type:', type);\n    }\n  }\n\n  normalizeColor(color) {\n    // If it's already a number (0xRRGGBB format), return it\n    if (typeof color === 'number') {\n      return color;\n    }\n\n    // If it's a hex string like \"#3498db\", convert to number\n    if (typeof color === 'string') {\n      if (color.startsWith('#')) {\n        return parseInt(color.substring(1), 16);\n      }\n      // If it's a string number like \"3498db\", convert to number\n      return parseInt(color, 16);\n    }\n\n    // Default color if something goes wrong\n    return 0x3498db;\n  }\n\n  updateRemoteObject(objectId, updates) {\n    console.log('Updating remote object:', objectId, updates);\n    this.updateObject(objectId, updates);\n  }\n\n  deleteRemoteObject(objectId) {\n    console.log('Deleting remote object:', objectId);\n    this.deleteObject(objectId);\n  }\n  \n  getObject(id) {\n    return this.objects.get(id);\n  }\n  \n  getAllObjects() {\n    return Array.from(this.objects.entries()).map(([id, obj]) => ({\n      id,\n      type: obj.constructor.name,\n      x: obj.x,\n      y: obj.y\n    }));\n  }\n  \n  // ==================== Remote Cursors ====================\n  \n  updateRemoteCursor(userId, username, x, y, color) {\n    let cursor = this.remoteCursors.get(userId);\n\n    // Convert color string (like \"#FF6B6B\") to number\n    const colorNum = color && typeof color === 'string' && color.startsWith('#')\n      ? parseInt(color.substring(1), 16)\n      : 0xFF6B6B;\n\n    if (!cursor) {\n      // Create new cursor\n      cursor = new PIXI.Container();\n\n      // Cursor pointer (triangle)\n      const pointer = new PIXI.Graphics();\n      pointer.beginFill(colorNum);\n      pointer.moveTo(0, 0);\n      pointer.lineTo(12, 18);\n      pointer.lineTo(6, 18);\n      pointer.lineTo(0, 24);\n      pointer.endFill();\n\n      // Username label\n      const label = new PIXI.Text(username, {\n        fontSize: 12,\n        fill: 0xFFFFFF,\n        backgroundColor: colorNum,\n        padding: 4\n      });\n      label.x = 15;\n      label.y = 0;\n\n      cursor.addChild(pointer);\n      cursor.addChild(label);\n      cursor.zIndex = 1000;\n\n      this.remoteCursors.set(userId, cursor);\n      this.viewport.addChild(cursor);\n    }\n\n    cursor.x = x;\n    cursor.y = y;\n  }\n  \n  removeRemoteCursor(userId) {\n    const cursor = this.remoteCursors.get(userId);\n    if (cursor) {\n      this.viewport.removeChild(cursor);\n      cursor.destroy();\n      this.remoteCursors.delete(userId);\n    }\n  }\n  \n  // ==================== Utilities ====================\n  \n  generateId() {\n    return 'obj-' + Math.random().toString(36).substr(2, 9);\n  }\n  \n  setColor(color) {\n    this.currentColor = color;\n  }\n  \n  getCanvasState() {\n    const objects = [];\n    this.objects.forEach((obj, id) => {\n      // Serialize object data\n      objects.push({\n        id,\n        type: obj.constructor.name,\n        x: obj.x,\n        y: obj.y,\n        // Add more properties as needed\n      });\n    });\n    return { objects };\n  }\n  \n  // Callbacks - set these from outside\n  onObjectCreated = null;\n  onObjectMoved = null;\n  onObjectDeleted = null;\n  onCursorMoved = null;\n}\n","// websocket.js - WebSocket client for real-time synchronization\n\nexport class WebSocketClient {\n    constructor(url, sessionId, canvasId) {\n        this.url = url\n        this.sessionId = sessionId\n        this.canvasId = canvasId\n        this.ws = null\n        this.isConnected = false\n        this.reconnectAttempts = 0\n        this.maxReconnectAttempts = 5\n        this.reconnectDelay = 1000\n\n        // Improved cursor throttling\n        this.lastCursorSend = 0\n        this.cursorSendInterval = 16 // ~60 FPS\n        this.pendingCursor = null\n        this.cursorAnimationFrame = null\n\n        // Callbacks\n        this.onAuthSuccess = () => {}\n        this.onAuthFailed = () => {}\n        this.onUserConnected = () => {}\n        this.onUserDisconnected = () => {}\n        this.onPresenceUpdate = () => {}\n        this.onCursorUpdate = () => {}\n        this.onObjectCreated = () => {}\n        this.onObjectUpdated = () => {}\n        this.onObjectDeleted = () => {}\n        this.onError = () => {}\n        this.onReconnecting = () => {}\n        this.onReconnected = () => {}\n    }\n\n    connect() {\n        console.log(`Connecting to WebSocket: ${this.url}`)\n\n        try {\n            this.ws = new WebSocket(this.url)\n            this.setupEventHandlers()\n        } catch (error) {\n            console.error('WebSocket connection error:', error)\n            this.onError(error)\n            this.scheduleReconnect()\n        }\n    }\n\n    setupEventHandlers() {\n        this.ws.onopen = () => {\n            console.log('WebSocket connected')\n            this.isConnected = true\n            this.reconnectAttempts = 0\n\n            // Send authentication message\n            this.send({\n                type: 'auth',\n                sessionId: this.sessionId,\n                canvasId: this.canvasId\n            })\n\n            if (this.reconnectAttempts > 0) {\n                this.onReconnected()\n            }\n        }\n\n        this.ws.onmessage = (event) => {\n            try {\n                const data = JSON.parse(event.data)\n                this.handleMessage(data)\n            } catch (error) {\n                console.error('Error parsing WebSocket message:', error)\n                this.onError(error)\n            }\n        }\n\n        this.ws.onclose = (event) => {\n            console.log('WebSocket disconnected:', event.code, event.reason)\n            this.isConnected = false\n\n            if (!event.wasClean) {\n                this.scheduleReconnect()\n            }\n        }\n\n        this.ws.onerror = (error) => {\n            console.error('WebSocket error:', error)\n            this.onError(error)\n        }\n    }\n\n    handleMessage(data) {\n        switch (data.type) {\n            case 'auth-success':\n                this.onAuthSuccess(data)\n                break\n\n            case 'auth-failed':\n                this.onAuthFailed(data)\n                break\n\n            case 'user-connected':\n                this.onUserConnected(data)\n                break\n\n            case 'user-disconnected':\n                this.onUserDisconnected(data)\n                break\n\n            case 'presence':\n                this.onPresenceUpdate(data.users)\n                break\n\n            case 'cursor':\n                this.onCursorUpdate(data)\n                break\n\n            case 'object-create':\n                this.onObjectCreated(data)\n                break\n\n            case 'object-update':\n                this.onObjectUpdated(data)\n                break\n\n            case 'object-delete':\n                this.onObjectDeleted(data)\n                break\n\n            case 'error':\n                console.error('Server error:', data.message)\n                this.onError(new Error(data.message))\n                break\n\n            default:\n                console.warn('Unknown message type:', data.type)\n        }\n    }\n\n    send(data) {\n        if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n            this.ws.send(JSON.stringify(data))\n        } else {\n            console.warn('WebSocket not connected, message not sent:', data)\n        }\n    }\n\n    sendCursorUpdate(x, y) {\n        // Store pending cursor position\n        this.pendingCursor = { x, y }\n\n        // If we haven't scheduled a send, schedule one\n        if (!this.cursorAnimationFrame) {\n            this.cursorAnimationFrame = requestAnimationFrame(() => {\n                this.processCursorUpdate()\n            })\n        }\n    }\n\n    processCursorUpdate() {\n        const now = performance.now()\n\n        // Check if enough time has passed since last send\n        if (now - this.lastCursorSend >= this.cursorSendInterval && this.pendingCursor) {\n            this.send({\n                type: 'cursor',\n                x: this.pendingCursor.x,\n                y: this.pendingCursor.y\n            })\n            this.lastCursorSend = now\n            this.pendingCursor = null\n            this.cursorAnimationFrame = null\n        } else if (this.pendingCursor) {\n            // Schedule another check\n            this.cursorAnimationFrame = requestAnimationFrame(() => {\n                this.processCursorUpdate()\n            })\n        } else {\n            this.cursorAnimationFrame = null\n        }\n    }\n\n    sendObjectCreate(object) {\n        this.send({\n            type: 'object-create',\n            object: object\n        })\n    }\n\n    sendObjectUpdate(objectId, updates) {\n        this.send({\n            type: 'object-update',\n            'object-id': objectId,\n            updates: updates\n        })\n    }\n\n    sendObjectDelete(objectId) {\n        this.send({\n            type: 'object-delete',\n            'object-id': objectId\n        })\n    }\n\n    scheduleReconnect() {\n        if (this.reconnectAttempts >= this.maxReconnectAttempts) {\n            console.error('Max reconnection attempts reached')\n            this.onError(new Error('Unable to reconnect to server'))\n            return\n        }\n\n        this.reconnectAttempts++\n        const delay = this.reconnectDelay * Math.pow(2, this.reconnectAttempts - 1)\n\n        console.log(`Attempting to reconnect in ${delay}ms (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`)\n        this.onReconnecting()\n\n        setTimeout(() => {\n            this.connect()\n        }, delay)\n    }\n\n    disconnect() {\n        if (this.ws) {\n            this.ws.close(1000, 'User disconnect')\n            this.ws = null\n            this.isConnected = false\n        }\n    }\n}","// auth.js - Authentication UI and logic for CollabCanvas\n\nexport class AuthManager {\n    constructor() {\n        this.modal = document.getElementById('auth-modal')\n        this.loginForm = document.getElementById('login-form')\n        this.registerForm = document.getElementById('register-form')\n        this.setupEventListeners()\n    }\n\n    setupEventListeners() {\n        // Tab switching\n        document.querySelectorAll('.tab-btn').forEach(btn => {\n            btn.addEventListener('click', () => {\n                const tab = btn.dataset.tab\n                this.switchTab(tab)\n            })\n        })\n\n        // Form submissions\n        this.loginForm.addEventListener('submit', async (e) => {\n            e.preventDefault()\n            await this.handleLogin()\n        })\n\n        this.registerForm.addEventListener('submit', async (e) => {\n            e.preventDefault()\n            await this.handleRegister()\n        })\n    }\n\n    switchTab(tab) {\n        // Update tab buttons\n        document.querySelectorAll('.tab-btn').forEach(btn => {\n            btn.classList.toggle('active', btn.dataset.tab === tab)\n        })\n\n        // Update forms\n        document.querySelectorAll('.auth-form').forEach(form => {\n            form.classList.toggle('active', form.id === `${tab}-form`)\n        })\n\n        // Clear errors\n        document.querySelectorAll('.error-message').forEach(err => {\n            err.textContent = ''\n        })\n    }\n\n    showModal() {\n        return new Promise((resolve) => {\n            this.modal.classList.remove('hidden')\n            this.resolveAuth = resolve\n        })\n    }\n\n    hideModal() {\n        this.modal.classList.add('hidden')\n    }\n\n    async handleLogin() {\n        const email = document.getElementById('login-email').value\n        const password = document.getElementById('login-password').value\n        const errorEl = document.getElementById('login-error')\n\n        try {\n            const response = await fetch('/api/login', {\n                method: 'POST',\n                credentials: 'include',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ email, password })\n            })\n\n            const data = await response.json()\n\n            if (data.success && data.data) {\n                this.hideModal()\n                this.resolveAuth({\n                    sessionId: data.data['session-id'],\n                    userId: data.data['user-id'],\n                    username: data.data.username\n                })\n            } else {\n                errorEl.textContent = data.error || 'Login failed'\n            }\n        } catch (error) {\n            console.error('Login error:', error)\n            errorEl.textContent = 'Connection error. Please try again.'\n        }\n    }\n\n    async handleRegister() {\n        const username = document.getElementById('register-username').value\n        const email = document.getElementById('register-email').value\n        const password = document.getElementById('register-password').value\n        const errorEl = document.getElementById('register-error')\n\n        try {\n            const response = await fetch('/api/register', {\n                method: 'POST',\n                credentials: 'include',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({ username, email, password })\n            })\n\n            const data = await response.json()\n\n            if (data.success) {\n                // Auto-login after registration\n                await this.loginAfterRegister(email, password)\n            } else {\n                errorEl.textContent = data.error || 'Registration failed'\n            }\n        } catch (error) {\n            console.error('Registration error:', error)\n            errorEl.textContent = 'Connection error. Please try again.'\n        }\n    }\n\n    async loginAfterRegister(email, password) {\n        // Switch to login tab\n        this.switchTab('login')\n\n        // Fill in credentials\n        document.getElementById('login-email').value = email\n        document.getElementById('login-password').value = password\n\n        // Auto-submit\n        await this.handleLogin()\n    }\n}","// main.js - Application entry point for CollabCanvas\n\nimport './styles.css'\nimport * as PIXI from 'pixi.js'\nimport { CanvasManager } from './canvas.js'\nimport { WebSocketClient } from './websocket.js'\nimport { AuthManager } from './auth.js'\n\nclass CollabCanvas {\n    constructor() {\n        this.canvasManager = null\n        this.wsClient = null\n        this.authManager = null\n        this.sessionId = null\n        this.userId = null\n        this.username = null\n        this.canvasId = this.getCanvasId()\n        this.activeUsers = [] // Track active users\n    }\n\n    getCanvasId() {\n        // Get canvas ID from URL or use default shared canvas\n        const params = new URLSearchParams(window.location.search)\n        let canvasId = params.get('canvas')\n\n        if (!canvasId) {\n            // Use a fixed default canvas so all users join the same one\n            canvasId = 'default-canvas'\n            // Update URL without reload\n            const newUrl = new URL(window.location)\n            newUrl.searchParams.set('canvas', canvasId)\n            window.history.replaceState({}, '', newUrl)\n        }\n\n        return canvasId\n    }\n\n    async init() {\n        console.log('Initializing CollabCanvas...')\n\n        // Update canvas ID in status bar\n        document.getElementById('canvas-id').textContent = this.canvasId\n\n        // Initialize authentication\n        this.authManager = new AuthManager()\n\n        // Check for existing session\n        this.sessionId = localStorage.getItem('sessionId')\n\n        if (this.sessionId) {\n            // Validate session with backend\n            const isValid = await this.validateSession()\n\n            if (!isValid) {\n                this.sessionId = null\n                localStorage.removeItem('sessionId')\n            }\n        }\n\n        if (!this.sessionId) {\n            // Hide loading screen and show auth modal\n            this.hideLoadingScreen()\n            const authData = await this.authManager.showModal()\n            this.sessionId = authData.sessionId\n            this.userId = authData.userId\n            this.username = authData.username\n            localStorage.setItem('sessionId', this.sessionId)\n        }\n\n        // Hide loading screen (session is valid)\n        this.hideLoadingScreen()\n\n        // Initialize canvas\n        this.initCanvas()\n\n        // Initialize WebSocket connection\n        this.initWebSocket()\n\n        // Setup UI event handlers\n        this.setupUIHandlers()\n\n        console.log('CollabCanvas initialized successfully')\n    }\n\n    hideLoadingScreen() {\n        const loadingScreen = document.getElementById('loading-screen')\n        if (loadingScreen) {\n            loadingScreen.classList.add('hidden')\n        }\n    }\n\n    async validateSession() {\n        try {\n            const response = await fetch('/api/session', {\n                credentials: 'include',\n                headers: {\n                    'Authorization': this.sessionId\n                }\n            })\n\n            if (response.ok) {\n                const data = await response.json()\n                if (data.success && data.data && data.data.valid) {\n                    this.userId = data.data['user-id']\n                    this.username = data.data.username\n                    console.log('Session restored:', this.username)\n                    return true\n                }\n            }\n        } catch (error) {\n            console.error('Session validation failed:', error)\n        }\n\n        return false\n    }\n\n    initCanvas() {\n        const container = document.getElementById('canvas-container')\n\n        // Create PixiJS application\n        const app = new PIXI.Application({\n            width: window.innerWidth,\n            height: window.innerHeight,\n            backgroundColor: 0x1a1a1a,\n            resizeTo: window\n        })\n\n        container.appendChild(app.view)\n\n        this.canvasManager = new CanvasManager(app)\n\n        // Set up canvas callbacks for WebSocket synchronization\n        this.canvasManager.onCursorMoved = (x, y) => {\n            if (this.wsClient && this.wsClient.isConnected) {\n                this.wsClient.sendCursorUpdate(x, y)\n            }\n        }\n\n        this.canvasManager.onObjectCreated = (object) => {\n            if (this.wsClient && this.wsClient.isConnected) {\n                this.wsClient.sendObjectCreate(object)\n            }\n        }\n\n        this.canvasManager.onObjectUpdated = (objectId, updates) => {\n            if (this.wsClient && this.wsClient.isConnected) {\n                this.wsClient.sendObjectUpdate(objectId, updates)\n            }\n        }\n\n        this.canvasManager.onObjectDeleted = (objectId) => {\n            if (this.wsClient && this.wsClient.isConnected) {\n                this.wsClient.sendObjectDelete(objectId)\n            }\n        }\n\n        // Update status bar callbacks\n        this.canvasManager.onToolChange = (tool) => {\n            document.getElementById('current-tool').textContent =\n                tool.charAt(0).toUpperCase() + tool.slice(1)\n        }\n\n        this.canvasManager.onMouseMove = (x, y) => {\n            document.getElementById('mouse-position').textContent = `${Math.round(x)}, ${Math.round(y)}`\n        }\n\n        this.canvasManager.onZoomChange = (zoom) => {\n            document.getElementById('zoom-level').textContent = `${Math.round(zoom * 100)}%`\n        }\n\n        this.canvasManager.onObjectCountChange = (count) => {\n            document.getElementById('object-count').textContent = count\n        }\n    }\n\n    initWebSocket() {\n        // Use wss:// for HTTPS pages, ws:// for HTTP\n        const wsProtocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:'\n        // window.location.host includes port if non-standard (e.g., localhost:8080)\n        const wsUrl = `${wsProtocol}//${window.location.host}/ws/${this.canvasId}`\n\n        this.wsClient = new WebSocketClient(wsUrl, this.sessionId, this.canvasId)\n\n        // Set up WebSocket callbacks\n        this.wsClient.onAuthSuccess = (data) => {\n            console.error('=== WebSocket authenticated ===')\n            console.error('Auth data received:', data)\n\n            // Backend sends 'canvas-state' (kebab-case), not 'canvasState'\n            const canvasState = data['canvas-state'] || data.canvasState\n            console.error('canvasState exists?', !!canvasState)\n            console.error('canvasState type:', typeof canvasState)\n            console.error('canvasState length:', canvasState ? canvasState.length : 0)\n\n            // Load initial canvas state\n            if (canvasState) {\n                console.error('=== CALLING loadState ===')\n                this.canvasManager.loadState(canvasState)\n                console.error('=== loadState RETURNED ===')\n            } else {\n                console.error('=== NO CANVAS STATE IN AUTH RESPONSE ===')\n            }\n        }\n\n        this.wsClient.onUserConnected = (data) => {\n            // Add new user to active users list\n            this.activeUsers.push({\n                'user-id': data.userId || data['user-id'],\n                username: data.username,\n                color: data.color\n            })\n            this.updatePresenceList(this.activeUsers)\n            this.showNotification(`${data.username} joined`, 'info')\n        }\n\n        this.wsClient.onUserDisconnected = (data) => {\n            // Remove user from active users list\n            const userId = data.userId || data['user-id']\n            this.activeUsers = this.activeUsers.filter(u =>\n                (u['user-id'] || u.userId) !== userId\n            )\n            this.updatePresenceList(this.activeUsers)\n            this.canvasManager.removeRemoteCursor(userId)\n            this.showNotification(`${data.username} left`, 'info')\n        }\n\n        this.wsClient.onPresenceUpdate = (users) => {\n            // Replace entire active users list with server's authoritative list\n            this.activeUsers = users\n            this.updatePresenceList(this.activeUsers)\n        }\n\n        this.wsClient.onCursorUpdate = (data) => {\n            this.canvasManager.updateRemoteCursor(\n                data.userId,\n                data.username,\n                data.x,\n                data.y,\n                data.color\n            )\n        }\n\n        this.wsClient.onObjectCreated = (data) => {\n            this.canvasManager.createRemoteObject(data.object)\n        }\n\n        this.wsClient.onObjectUpdated = (data) => {\n            // Backend sends 'object-id' (kebab-case)\n            const objectId = data['object-id'] || data.objectId\n            this.canvasManager.updateRemoteObject(objectId, data.updates)\n        }\n\n        this.wsClient.onObjectDeleted = (data) => {\n            // Backend sends 'object-id' (kebab-case)\n            const objectId = data['object-id'] || data.objectId\n            this.canvasManager.deleteRemoteObject(objectId)\n        }\n\n        this.wsClient.onError = (error) => {\n            console.error('WebSocket error:', error)\n            this.showNotification('Connection error', 'error')\n        }\n\n        this.wsClient.onReconnecting = () => {\n            this.showNotification('Reconnecting...', 'warning')\n        }\n\n        this.wsClient.onReconnected = () => {\n            this.showNotification('Reconnected', 'success')\n        }\n\n        // Connect to WebSocket\n        this.wsClient.connect()\n    }\n\n    setupUIHandlers() {\n        // Tool buttons\n        document.querySelectorAll('.tool-btn').forEach(btn => {\n            btn.addEventListener('click', () => {\n                const tool = btn.dataset.tool\n                this.canvasManager.setTool(tool)\n\n                // Update active button\n                document.querySelectorAll('.tool-btn').forEach(b =>\n                    b.classList.remove('active'))\n                btn.classList.add('active')\n            })\n        })\n\n        // Color picker\n        const colorPicker = document.getElementById('color-picker')\n        colorPicker.addEventListener('change', (e) => {\n            this.canvasManager.setColor(e.target.value)\n        })\n\n        // Keyboard shortcuts\n        document.addEventListener('keydown', (e) => {\n            // Prevent shortcuts when typing in inputs\n            if (e.target.tagName === 'INPUT') return\n\n            switch(e.key.toLowerCase()) {\n                case 'v':\n                    this.selectTool('select')\n                    break\n                case 'r':\n                    this.selectTool('rectangle')\n                    break\n                case 'c':\n                    this.selectTool('circle')\n                    break\n                case 'delete':\n                case 'backspace':\n                    if (!e.target.isContentEditable) {\n                        e.preventDefault()\n                        this.canvasManager.deleteSelected()\n                    }\n                    break\n                case 'z':\n                    if (e.ctrlKey || e.metaKey) {\n                        e.preventDefault()\n                        if (e.shiftKey) {\n                            this.canvasManager.redo()\n                        } else {\n                            this.canvasManager.undo()\n                        }\n                    }\n                    break\n            }\n        })\n\n        // Logout button (if added to UI)\n        const logoutBtn = document.getElementById('logout-btn')\n        if (logoutBtn) {\n            logoutBtn.addEventListener('click', async () => {\n                await this.logout()\n            })\n        }\n    }\n\n    selectTool(tool) {\n        this.canvasManager.setTool(tool)\n\n        // Update UI\n        document.querySelectorAll('.tool-btn').forEach(btn => {\n            if (btn.dataset.tool === tool) {\n                btn.classList.add('active')\n            } else {\n                btn.classList.remove('active')\n            }\n        })\n    }\n\n    updatePresenceList(users = []) {\n        const container = document.getElementById('users-container')\n        container.innerHTML = ''\n\n        users.forEach(user => {\n            const userItem = document.createElement('div')\n            userItem.className = 'user-item'\n            // Handle both kebab-case and camelCase keys\n            const username = user.username\n            const color = user.color\n            userItem.innerHTML = `\n                <span class=\"user-indicator\" style=\"background-color: ${color}\"></span>\n                <span>${username}</span>\n            `\n            container.appendChild(userItem)\n        })\n    }\n\n    showNotification(message, type = 'info') {\n        // Simple notification system (can be enhanced with a library)\n        console.log(`[${type.toUpperCase()}] ${message}`)\n\n        // TODO: Implement visual notifications\n    }\n\n    async logout() {\n        try {\n            await fetch('/api/logout', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': this.sessionId\n                }\n            })\n        } catch (error) {\n            console.error('Logout error:', error)\n        }\n\n        // Clean up\n        localStorage.removeItem('sessionId')\n        this.wsClient.disconnect()\n\n        // Reload page to show login\n        window.location.reload()\n    }\n}\n\n// Initialize application when DOM is ready\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n        const app = new CollabCanvas()\n        app.init()\n        window.collabCanvas = app // For debugging\n    })\n} else {\n    const app = new CollabCanvas()\n    app.init()\n    window.collabCanvas = app // For debugging\n}"],"names":["CanvasManager","app","__publicField","PIXI.Container","grid","PIXI.Graphics","gridSize","gridExtent","x","y","canvas","e","dx","dy","zoomFactor","mouseX","mouseY","worldPosBefore","newScale","worldPosAfter","screenX","screenY","worldX","worldY","tool","drawStart","previewShape","worldPos","width","height","radius","objData","start","end","id","color","rect","circle","text","fontSize","textObj","PIXI.Text","obj","dragData","dragOffset","lastDragUpdate","dragUpdateInterval","event","cursorPos","newPosition","now","existingIndicator","indicator","canvasState","index","values","updates","type","objectId","userId","username","cursor","colorNum","pointer","label","objects","WebSocketClient","url","sessionId","canvasId","error","data","object","delay","AuthManager","btn","tab","form","err","resolve","email","password","errorEl","CollabCanvas","newUrl","authData","loadingScreen","response","container","PIXI.Application","zoom","count","wsProtocol","wsUrl","u","users","b","logoutBtn","user","userItem","message"],"mappings":"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"}